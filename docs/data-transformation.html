<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Data transformation | How well does the APBA baseball board game model reality?</title>
  <meta name="description" content="Chapter 3 Data transformation | How well does the APBA baseball board game model reality?" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Data transformation | How well does the APBA baseball board game model reality?" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Data transformation | How well does the APBA baseball board game model reality?" />
  
  
  

<meta name="author" content="Barbara Bettencourt, Gregor Hanuschak, Zicheng Huang" />


<meta name="date" content="2021-04-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-sources.html"/>
<link rel="next" href="missing-values.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SHORT TITLE HERE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>2</b> Data sources</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-sources.html"><a href="data-sources.html#batting-table"><i class="fa fa-check"></i><b>2.1</b> Batting Table</a></li>
<li class="chapter" data-level="2.2" data-path="data-sources.html"><a href="data-sources.html#pitching-table"><i class="fa fa-check"></i><b>2.2</b> Pitching Table</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>3</b> Data transformation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-transformation.html"><a href="data-transformation.html#web-scrapped-batting-table"><i class="fa fa-check"></i><b>3.1</b> Web Scrapped Batting Table</a></li>
<li class="chapter" data-level="3.2" data-path="data-transformation.html"><a href="data-transformation.html#web-scrapped-pitching-table"><i class="fa fa-check"></i><b>3.2</b> Web Scrapped Pitching Table</a></li>
<li class="chapter" data-level="3.3" data-path="data-transformation.html"><a href="data-transformation.html#cleaning-the-combined-data"><i class="fa fa-check"></i><b>3.3</b> Cleaning the Combined Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>4</b> Missing values</a></li>
<li class="chapter" data-level="5" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>5</b> Results</a></li>
<li class="chapter" data-level="6" data-path="interactive-component.html"><a href="interactive-component.html"><i class="fa fa-check"></i><b>6</b> Interactive component</a></li>
<li class="chapter" data-level="7" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>7</b> Conclusion</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">How well does the APBA baseball board game model reality?</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-transformation" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Data transformation</h1>
<p>For our scoresheet data, when we were done tabulating all the statistics for all the players in Excel, we exported each tab into a CSV file and then read those CSV files into R Studio. We made one data frame to hold the hitting statistics and one data frame to hold the pitching statistics.</p>
<p>There was some minor data cleanup to do for these data frames. There were many cells in Excel that were purposely left empty. For example, if a hitter never had a homerun in APBA baseball, that cell would have been left blank during the tabulation process, but the blank cell really represented a “0”.
When you import into R Studio from a CSV however, these blanks cells turn into “NA”s, so we needed to use R Studio commands to turn these NAs into the 0s they represent.</p>
<div id="web-scrapped-batting-table" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Web Scrapped Batting Table</h2>
<p>We need to add the following calculated fields into the web scrapped batting data to better measure the performance of the hitters:</p>
<ul>
<li><p><span class="math inline">\(\text{AVG}=\dfrac{\text{hits(H)}}{\text{at bats(AB)}}\)</span></p></li>
<li><p><span class="math inline">\(\text{SLG}=\dfrac{\text{first base(1B)}+\text{second base(2B)}\times2+\text{third base(3B)}\times3+\text{home runs(HR)}\times4}{\text{at bats(AB)}}\)</span></p></li>
<li><p><span class="math inline">\(\text{OBA}=\dfrac{\text{hits(H)}+\text{bases on balls(BB)}+\text{times hit by a pitch(HBP)}}{\text{at bats(AB)}+\text{bases on balls(BB)}+\text{times hit by a pitch(HBP)}}\)</span></p></li>
<li><p><span class="math inline">\(\text{SAC}=\text{sacrifice hits(SH)}+\text{sacrifice flies(SF)}\)</span></p></li>
</ul>
<p>The resulting real-life batting table looks like:</p>
<pre><code>## tibble [211 x 21] (S3: tbl_df/tbl/data.frame)
##  $ playerID: chr [1:211] &quot;abbotku01&quot; &quot;abreubo01&quot; &quot;aguilri01&quot; &quot;alfoned01&quot; ...
##  $ name    : chr [1:211] &quot;Kurt Abbott&quot; &quot;Bobby Abreu&quot; &quot;Rick Aguilera&quot; &quot;Edgardo Alfonzo&quot; ...
##  $ hits    : chr [1:211] &quot;Right&quot; &quot;Left&quot; &quot;Right&quot; &quot;Right&quot; ...
##  $ AVG     : num [1:211] 0.263 0.312 NaN 0.278 0.274 ...
##  $ SLG     : num [1:211] 0.418 0.497 NaN 0.427 0.425 ...
##  $ OBA     : num [1:211] 0.312 0.411 NaN 0.357 0.375 ...
##  $ G       : num [1:211] 77 151 5 144 101 159 73 92 56 1 ...
##  $ AB      : num [1:211] 194 497 0 557 259 584 134 107 133 3 ...
##  $ R       : num [1:211] 26 68 0 94 51 104 25 7 17 0 ...
##  $ H       : num [1:211] 51 155 0 155 71 182 37 20 39 0 ...
##  $ RBI     : num [1:211] 24 74 0 78 33 124 4 10 16 0 ...
##  $ 2B      : num [1:211] 13 29 0 28 15 34 6 5 8 0 ...
##  $ 3B      : num [1:211] 1 6 0 2 3 5 0 0 0 0 ...
##  $ HR      : num [1:211] 5 17 0 17 6 38 1 1 1 0 ...
##  $ SAC     : num [1:211] 4 8 0 5 7 6 1 4 2 0 ...
##  $ SB      : num [1:211] 2 19 0 8 4 11 11 0 2 0 ...
##  $ CS      : num [1:211] 1 10 0 3 3 3 1 0 0 0 ...
##  $ SO      : num [1:211] 53 133 0 77 40 87 24 15 18 2 ...
##  $ BB      : num [1:211] 12 84 0 65 37 84 13 6 13 0 ...
##  $ HBP     : num [1:211] 2 0 0 3 5 5 1 0 1 0 ...
##  $ TB      : num [1:211] 81 247 0 238 110 340 46 28 50 0 ...</code></pre>
</div>
<div id="web-scrapped-pitching-table" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Web Scrapped Pitching Table</h2>
<p>Then we need to add the following calculated fields into the web scrapped pitching data to better measure the performance of the pitchers:</p>
<ul>
<li><span class="math inline">\(\text{AVG_against}=\dfrac{\text{hits(H)}}{\text{hits(H)}+\text{innings pitched(IP)}\times3}\)</span></li>
</ul>
<p>The resulting real-life pitching table looks like:</p>
<pre><code>## tibble [83 x 19] (S3: tbl_df/tbl/data.frame)
##  $ playerID   : chr [1:83] &quot;aguilri01&quot; &quot;arrojro01&quot; &quot;ashbyan01&quot; &quot;assenpa01&quot; ...
##  $ name       : chr [1:83] &quot;Rick Aguilera&quot; &quot;Rolando Arrojo&quot; &quot;Andy Ashby&quot; &quot;Paul Assenmacher&quot; ...
##  $ throws     : chr [1:83] &quot;Right&quot; &quot;Right&quot; &quot;Right&quot; &quot;Left&quot; ...
##  $ ERA        : num [1:83] 4.24 3.56 3.34 3.26 5.02 7.29 3.02 5.15 4.27 3.23 ...
##  $ W          : num [1:83] 4 14 17 2 10 1 3 3 14 4 ...
##  $ L          : num [1:83] 9 12 9 5 7 10 4 9 14 8 ...
##  $ SV         : num [1:83] 38 0 0 3 0 8 51 0 0 1 ...
##  $ AVG_against: num [1:83] 0.252 0.243 0.247 0.277 0.257 ...
##  $ G          : num [1:83] 68 32 33 69 34 62 81 21 34 40 ...
##  $ GS         : num [1:83] 0 32 33 0 23 0 0 21 34 0 ...
##  $ CG         : num [1:83] 0 2 5 0 0 0 0 0 2 0 ...
##  $ IP         : num [1:83] 74.1 202 226.2 47 123.2 ...
##  $ ER         : num [1:83] 35 80 84 17 69 61 27 67 111 22 ...
##  $ H          : num [1:83] 75 195 223 54 128 100 86 126 247 46 ...
##  $ SO         : num [1:83] 57 152 151 43 57 68 81 113 130 57 ...
##  $ BB         : num [1:83] 15 65 58 19 64 26 20 63 73 28 ...
##  $ HBP        : num [1:83] 1 19 7 1 4 1 2 4 7 1 ...
##  $ WP         : num [1:83] 1 3 7 0 7 4 2 8 6 3 ...
##  $ BK         : num [1:83] 0 1 0 0 0 0 0 0 1 0 ...</code></pre>
</div>
<div id="cleaning-the-combined-data" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Cleaning the Combined Data</h2>
<p>Once real data was scraped into CSV files (again, one file for hitting and one for pitching), these were also put into their own data frames. We then consolidated the information from the game hitting and real hitting data frames into the same data frame such that every row in the consolidated hitting data frame had all the relevant information for the same player. For example, hitting data frame[1] had both game and real hitting data for “Derek Jeter”.</p>
<p>We then proceeded to remove all players from the consolidated hitting data frame that had either 0 at-bats (AB) in the game or 0 AB in real life. For these players, we had no good way to analyze or evaluate how well APBA was representing them.</p>
<p>For players with 0 AB in the game, there was nothing to compare against real life. In the game, these players were mainly relief pitchers. Relief pitchers do hit, but it’s rare, and such players didn’t pitch in enough games to eventually get the chance to hit.</p>
<p>For players with 0 AB in real life, there was nothing to compare game data to. In real life, these players were all pitchers in the American League since, in the American League, pitchers never hit and instead have another player designated to hit for them (a so-called “designated hitter”).</p>
<p>Once these rows were removed from the consolidated hitting data frame, we looked at the remaining rows (each row representing a player) and proceeded to calculate how many of each interesting statistic the player should have had in the board game in order to be completely real-life accurate. Statistics we thought were interesting were hits (H), total bases (TB), runs (R), runs batted in (RBI), doubles (2B), triples (3B), homeruns (HR), and stolen bases (SB).</p>
<p>Batting average (AVG) is a derived statistic equal to H / AB while slugging percentage (SLG) is a derived statistic equal to TB / AB. This means that AVG<span class="math inline">\(\times\)</span>AB = H and SLG<span class="math inline">\(\times\)</span>AB = TB, so, to get the number of H a player should have had in the game, we multiply his real-life AVG with the number of AB he had in the game. Similarly, to get the number of TB a player should have had in the game, we multiply his real-life SLG with the number of AB he had in the game.</p>
<p>(?)Although not derived statistics typically used in baseball, we can make our own version of AVG and SLG for the other statistics, based on either AB or games played (G) as seemed appropriate.</p>
<p>Now, for each hitter, we have the expected number of H, TB, R, RBI, 2B, 3B, HR, and SB he should have had in the game and the actual number of H, TB, R, RBI, 2B, 3B, HR, and SB he had in the game. Therefore, we can find the deviation from reality for each of these statistics by taking the difference between game and expected versions.</p>
<p>Now for pitchers, the entire process is quite similar. We consolidated the information from the game pitching and real pitching data frames into the same data frame such that every row in the consolidated data frame had all the relevant information for the same pitcher. For example, pitching data frame[1] had both game and real pitching data for “Brian Bohanon”.</p>
<p>For pitchers, we look at the number of innings pitched (IP) or games pitched (G) in the game to determine how many of the other statistics pitchers should have. The standard baseball derived statistic, “earned run average” (ERA), can be used with IP to determine how many earned runs (ER) the player should have. Once again, we make up our own similarly derived statistics to determine how many of the other pitching statistics pitchers should have.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-sources.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="missing-values.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/zichenghuang/baseball-board-game/edit/main/03-cleaning.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/zichenghuang/baseball-board-game/blob/main/03-cleaning.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
